Расписал подробно комментариями в коде